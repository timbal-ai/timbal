- name: "dev"
  description: "eval used for development"

  tags: ["dev", "datetime"]
  timeout: 30000

  params:
    prompt: what time is it in madrid

  # Validate the final output
  output:
    type!: "string"
    min_length!: 10
    contains!: ":"
    pattern!: "\\d{1,2}:\\d{2}"
    semantic!: "a time response mentioning Madrid"

  seq!:
    - llm:
        output:
          not_null!: true
          min_length!: 1
    - get_datetime:
        input:
          timezone:
            eq!: "Europe/Madrid"
            starts_with!: "Europe/"
        output:
          type!: "string"
          pattern!: "^\\d{4}-\\d{2}-\\d{2}"

- name: "multi_tool_complex"
  description: "Complex eval with multiple tools and nested validation"

  tags: ["complex", "multi-tool"]
  timeout: 60000

  params:
    prompt: search for electric cars under 50000 and book a test drive

  output:
    semantic!: "confirmation of test drive booking"
    not_contains!: "error"
    language!: "en"

  seq!:
    - llm
    - search_cars:
        input:
          query:
            contains!: "electric"
            semantic!: "searching for electric vehicles"
          max_price:
            lte!: 50000
            positive!: true
        output:
          type!: "array"
          min_size!: 1
          max_size!: 20
    - llm:
        output:
          min_length!: 50
    - book_test_drive:
        input:
          car_id:
            not_null!: true
            type!: "string"
          date:
            pattern!: "^\\d{4}-\\d{2}-\\d{2}$"
            after!: "2024-01-01"
        output:
          has_keys!: ["confirmation_id", "status"]
          status:
            one_of!: ["confirmed", "pending"]

- name: "subagent_workflow"
  description: "Eval with nested subagent calls"

  tags: ["subagent", "nested"]
  timeout: 120000

  params:
    prompt: analyze the market and create a report

  output:
    min_length!: 200
    semantic!: "a comprehensive market analysis report"
    sentiment!: "neutral"

  seq!:
    - llm
    - research_agent:
        seq!:
          - llm
          - web_search:
              input:
                query:
                  min_length!: 5
                  not_contains!: "hack"
              output:
                type!: "array"
                min_size!: 3
          - llm
        output:
          type!: "object"
          required_keys!: ["findings", "sources"]
    - llm
    - report_generator:
        parallel!:
          - create_charts:
              output:
                type!: "array"
                min_size!: 1
          - format_text:
              output:
                min_length!: 100
        output:
          has_key!: "report_url"

- name: "validation_edge_cases"
  description: "Testing various validator combinations"

  tags: ["edge-cases", "validation"]
  timeout: 30000

  params:
    prompt: validate user registration

  seq!:
    - validate_user:
        input:
          email:
            email!: true
            ends_with!: ".com"
            not_contains!: "spam"
          username:
            min_length!: 3
            max_length!: 20
            alphanumeric!: true
            lowercase!: true
          age:
            gte!: 18
            lte!: 120
            type!: "number"
          tags:
            type!: "array"
            unique!: true
            max_size!: 5
            all!:
              type!: "string"
              min_length!: 2
        output:
          or!:
            - eq!: "success"
            - and!:
                - has_key!: "errors"
                - type!: "object"
